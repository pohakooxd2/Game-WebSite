var adsManager,adsLoader,adDisplayContainer,intervalTimer,playGame,adContainer=document.getElementById("adContainer"),playButton=document.getElementById("playGame"),loader=document.getElementById("loader"),gameWidth=loader.offsetWidth,gameHeight=loader.offsetHeight,started=!1;function onWindowResize(){adContainerWidth=loader.offsetWidth,adContainerHeight=loader.offsetHeight,adsManager&&adsManager.resize(adContainerWidth,adContainerHeight,google.ima.ViewMode.FULLSCREEN)}function removeAd(){$("#playGame").length?(playButton.removeEventListener("click",playAds),playButton.addEventListener("click",removeAdContainer),adsManager&&adsManager.destroy()):removeAdContainer()}function generateAdTagUrl(){var adTagUrl="https://googleads.g.doubleclick.net/pagead/ads?",adParams={};for(var adParam in adParams.client=adcode,adParams.ad_type="video_image_text",adParams.description_url=encodeURIComponent(document.location),adParams.videoad_start_delay="0",adParams.max_ad_duration="15000",adParams)adTagUrl+=adParam+"="+adParams[adParam]+"&";return adTagUrl=adTagUrl.substring(0,adTagUrl.length-1)}function setUpIMA(){if(createAdDisplayContainer()){(adsLoader=new google.ima.AdsLoader(adDisplayContainer)).addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,onAdsManagerLoaded,!1),adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,onAdError,!1);var adsRequest=new google.ima.AdsRequest;adsRequest.adTagUrl=generateAdTagUrl(),adsRequest.linearAdSlotWidth=gameWidth,adsRequest.linearAdSlotHeight=gameHeight,adsRequest.nonLinearAdSlotWidth=gameWidth,adsRequest.nonLinearAdSlotHeight=gameHeight,adsRequest.forceNonLinearFullSlot=!0,adsLoader.requestAds(adsRequest)}else removeAd()}function createAdDisplayContainer(){return"undefined"!=typeof google&&(adDisplayContainer=new google.ima.AdDisplayContainer(adContainer),!0)}function playAds(){$("#playGame").remove(),adDisplayContainer.initialize(),adsManager?initAds():setTimeout((function(){initAds()}),1e3)}function initAds(){try{adsManager.init(gameWidth,gameHeight,google.ima.ViewMode.NORMAL),adsManager.start()}catch(adError){removeAd()}window.addEventListener("resize",onWindowResize),onWindowResize()}function init(){started=!0,playButton.addEventListener("click",playAds),setUpIMA()}function onAdsManagerLoaded(adsManagerLoadedEvent){var adsRenderingSettings=new google.ima.AdsRenderingSettings;adsRenderingSettings.restoreCustomPlaybackStateOnAdBreakComplete=!0,(adsManager=adsManagerLoadedEvent.getAdsManager(adContainer,adsRenderingSettings)).addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,onAdError),adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,onContentPauseRequested),adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,onContentResumeRequested),adsManager.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,onAdEvent),adsManager.addEventListener(google.ima.AdEvent.Type.LOADED,onAdEvent),adsManager.addEventListener(google.ima.AdEvent.Type.STARTED,onAdEvent),adsManager.addEventListener(google.ima.AdEvent.Type.COMPLETE,onAdEvent)}function onAdEvent(adEvent){var ad=adEvent.getAd();switch(adEvent.type){case google.ima.AdEvent.Type.LOADED:ad.isLinear()||setTimeout((function(){removeAd()}),6e3);break;case google.ima.AdEvent.Type.STARTED:ad.isLinear()&&(intervalTimer=setInterval((function(){var remainingTime=adsManager.getRemainingTime()}),300));break;case google.ima.AdEvent.Type.COMPLETE:ad.isLinear()&&clearInterval(intervalTimer)}}function onAdError(adErrorEvent){removeAd()}function onContentPauseRequested(){}function onContentResumeRequested(){removeAd()}var cmpOk="false";try{__tcfapi("addEventListener",2,(function(tcData,success){cmpOk="true",success&&tcData.gdprApplies?"tcloaded"===tcData.eventStatus?init():"useractioncomplete"===tcData.eventStatus&&init():init()}))}catch(e){cmpOk="true",init()}setTimeout((function(){"false"==cmpOk&&init()}),3e3);